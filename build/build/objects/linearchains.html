<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>LinearChain Â· IonSim.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://docs.ionsim.org/objects/linearchains.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><script src="../assets/js/link-back.js"></script><link href="../assets/small-logo.png" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.svg" alt="IonSim.jl logo"/></a><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><a class="tocitem" href="../installation.html">Installation</a></li><li><a class="tocitem" href="../tutorial.html">Tutorial</a></li><li><span class="tocitem">Constructing a Trapped Ion Experiment</span><ul><li><a class="tocitem" href="ions.html">Ion</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox" checked/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">IonTraps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="iontraps.html">IonTrap</a></li><li class="is-active"><a class="tocitem" href="linearchains.html">LinearChain</a><ul class="internal"><li><a class="tocitem" href="#Theoretical-Background"><span>Theoretical Background</span></a></li><li><a class="tocitem" href="#Purpose"><span>Purpose</span></a></li><li><a class="tocitem" href="#Buiding-a-LinearChain"><span>Buiding a LinearChain</span></a></li><li><a class="tocitem" href="#Buiding-from-YAML"><span>Buiding from YAML</span></a></li><li><a class="tocitem" href="#Additional-Functionality"><span>Additional Functionality</span></a></li></ul></li><li><a class="tocitem" href="vibrationalmodes.html">VibrationalMode</a></li></ul></li><li><a class="tocitem" href="emfields.html">ElectroMagneticField</a></li><li><a class="tocitem" href="waveforms.html">WaveForm</a></li><li><a class="tocitem" href="chambers.html">Chamber</a></li></ul></li><li><a class="tocitem" href="../hamiltonian.html">Constructing the Hamiltonian</a></li><li><span class="tocitem">Simulation</span><ul><li><a class="tocitem" href="../timeevolution/solve.html">Solve</a></li><li><a class="tocitem" href="../timeevolution/rotatingframes.html">RotatingFrame</a></li><li><a class="tocitem" href="../timeevolution/technicalnoise.html">Technical Noise</a></li><li><a class="tocitem" href="../timeevolution/quantumnoise.html">Quantum Noise</a></li></ul></li><li><a class="tocitem" href="../examples.html">Examples</a></li><li><a class="tocitem" href="../api.html">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Constructing a Trapped Ion Experiment</a></li><li><a class="is-disabled">IonTraps</a></li><li class="is-active"><a href="linearchains.html">LinearChain</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="linearchains.html">LinearChain</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="LinearChain"><a class="docs-heading-anchor" href="#LinearChain">LinearChain</a><a id="LinearChain-1"></a><a class="docs-heading-anchor-permalink" href="#LinearChain" title="Permalink"></a></h1><h2 id="Theoretical-Background"><a class="docs-heading-anchor" href="#Theoretical-Background">Theoretical Background</a><a id="Theoretical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-Background" title="Permalink"></a></h2><p>In some sense a linear chain is the simplest configuration of ions, but it is also the most common. Ions are trapped in effective three-dimensional, harmonic electric potential <span>$V$</span>:</p><p class="math-container">\[V \propto m\omega_x^2x^2 + m\omega_y^2y^2 + m\omega_z^2z^2\]</p><p>where the magnitude of <span>$\omega_z$</span> is set to be signficantly smaller than <span>$\omega_x$</span> and <span>$\omega_y$</span>. With this choice, if in addition the kinetic energy of the ions is sufficiently small, the ions will <em>crystallize</em> into the shape of a linear chain along the <span>$z$</span>-direction where the confining force due to the external potential is perfectly balanced by the inter-ion Coulomb repulsion. </p><p>Any residual motion can then be described by small excursions of the ions away from their equilibrium positions where the inter-ion Coulomb repulsion (no longer zero) is well described to first-order. I.e. the Coulomb interaction can be linearized such that the resulting motion is analagous to a linear spring-mass system. </p><p>For example, the motion of the <span>$i^{th}$</span> ion in the <span>$x$</span>-direction is given by:</p><p class="math-container">\[m\ddot{x}&#39;_i = -\sum_j K_{ij} x&#39;_j\]</p><p>where <span>$x&#39;_i$</span> is the diplacement of the <span>$i^{th}$</span> ion from equilibrium and <span>$K_{ij}$</span> describes the (first-order) force per unit length that ion <code>i</code> experiences due to a change in position of ion <code>j</code>. By diagonalizing <span>$K$</span>, we find a collection of normal modes <span>$\beta^k$</span> and associated eigenfrequencies <span>$\nu_k$</span> such that a general solution for <span>$x$</span> is given by:</p><p class="math-container">\[x&#39;_i(t) = \sum_k c_k \beta^k_i e^{i\nu_k t}\]</p><p>But in this regime, the kinetic energy of the ions is comparable to the ground state energy so the description must be quantized. It turns out, this can be done by associating a quantum harmonic oscillator with each normal mode <span>$\beta^k$</span>, such that the displacement of ion <span>$i$</span> from equilibrium is given by:</p><p class="math-container">\[\hat{x}&#39;_i = \sum_k c_k \beta_i^k \sqrt{\frac{\hbar}{2m\nu_k}}(\hat{a}_k^{\dagger} + \hat{a}_k) \]</p><p>where <span>$\hat{a}^{\dagger}_k$</span> and  <span>$\hat{a}_k$</span> satisfy the normal commutation relation <span>$[\hat{a}_k, \hat{a}^{\dagger}_k] =1$</span>. Given a collection of ions defined by their mass and charge, IonSim will solve for these normal modes of motion and their associated vibrational frequencies. </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In the above, we&#39;ve implicitly assumed that the ions were identical in mass and charge. The situation is a bit more complicated when this is no longer true, but IonSim can handle these situations as well.</p></div></div><h2 id="Purpose"><a class="docs-heading-anchor" href="#Purpose">Purpose</a><a id="Purpose-1"></a><a class="docs-heading-anchor-permalink" href="#Purpose" title="Permalink"></a></h2><p><strong>DocString</strong>: <a href="../api.html#IonSim.LinearChain"><code>LinearChain</code></a></p><p>The main purpose of a <code>LinearChain</code> object is to organize and store information about the coupled center of mass motion for a chain of ions, which can then be used to construct a <a href="../api.html#IonSim.Chamber"><code>Chamber</code></a> as a next step towards simulating a trapped ion experiment. Assuming a harmonic potential confining potential and a linearized, inter-ion Coulomb interaction as described earlier, the structure of this motion is uniquely specified given three frequencies. </p><h2 id="Buiding-a-LinearChain"><a class="docs-heading-anchor" href="#Buiding-a-LinearChain">Buiding a LinearChain</a><a id="Buiding-a-LinearChain-1"></a><a class="docs-heading-anchor-permalink" href="#Buiding-a-LinearChain" title="Permalink"></a></h2><p>Creating an instance of <code>LinearChain</code> requires three arguments:</p><ul><li><code>ions</code>: An iterable collection of ions<code>&lt;:Ion</code>.</li><li><code>comfrequencies</code>: A <code>NamedTuple{:x, :y, :z}</code> specifying the vibrational frequencies for the center of mass modes, e.g. <code>comfrequencies = (x=3e6, y=3e6, z=1e6)</code>.</li><li><code>selectedmodes</code>: Another <code>NamedTuple{:x, :y, :z}</code> but with arguments that are lists of integers e.g. <code>selectedmodes = (x=[1, 3], y=[:], z=[1:3, 5])</code>. These specify a subset of the normal modes that will actually be taken into account during simulation.</li></ul><p>An optional keyword argument <code>N::Int</code> can be specified, which sets the Hilbert space dimension assoicated with each generated normal mode (this defaults to 10).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In the case that all ions have the same mass and charge, the COM motion of the ion chain factors into three unique modes (one for each spatial coordinate). And these are typically used to characterize the normal mode structure of the chain since they are the same independent of the number of ions. </p><p>However, When the ions are not identical, this is no longer true. In this case, <code>comfrequencies</code> corresponds to the lowest (highest) frequency normal mode in the axial (radial) directions, in correspondence with the homogeneous case.</p></div></div><p>For example:</p><pre><code class="language-julia hljs">c = Ca40()
b = Be9()
chain = LinearChain(
    ions=[c, c, b, b],
    comfrequencies=(x=7e6,y=7e6,z=1e6),
    selectedmodes=(x=[:], y=[1:3], z=[1, 2])  # Note: selectedmodes now supports slicing
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearChain(4 ions)</code></pre><p>Creates a 4-ion chain of two calcium ions and 2 beryllium ions where the smallest normal mode axial frequency is 1 MHz and the largest frequency in both of the radial directions is 7 MHz. <code>chain</code> has four fields (which you can see by typing a period and hitting the tab key).</p><p><img src="../assets/tab-completion-example.png" alt/></p><p><code>chain.comfrequencies</code> and <code>chain.ions</code> correspond to the arguments used to instantiate <code>chain</code>. <code>chain.ionpositions</code> is a vector of floats representing the positions of the ions in the chain in meters:</p><pre><code class="language-julia hljs">ionpositions(chain) .* 1e6</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
 -24.5357855124788
  -7.759277677351928
   7.759277677351928
  24.5357855124788</code></pre><p><code>chain.selectedmodes</code> now contains a NamedTuple of <code>VibrationalMode</code>s:</p><pre><code class="language-julia hljs">selectedmodes(chain).x</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{VibrationalMode}:
 VibrationalMode(Î½=7.0e6, axis=xÌ, N=10)
 VibrationalMode(Î½=6.433e6, axis=xÌ, N=10)
 VibrationalMode(Î½=1.355e6, axis=xÌ, N=10)
 VibrationalMode(Î½=282700.0, axis=xÌ, N=10)</code></pre><p>which are quantum operators further described in the <a href="../api.html#IonSim.VibrationalMode"><code>VibrationalMode</code></a> section.</p><pre><code class="language-julia hljs">typeof(selectedmodes(chain).x[1]) &lt;: IonSimBasis</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>The normal mode structure can be better understood by using IonSim&#39;s <code>visualize</code> function:</p><pre><code class="language-julia hljs">using Plots
visualize(chain, zÌ, [:])</code></pre><pre><code class="language-julia hljs">visualize(chain, xÌ, [:], format=&quot;circles&quot;)</code></pre><h2 id="Buiding-from-YAML"><a class="docs-heading-anchor" href="#Buiding-from-YAML">Buiding from YAML</a><a id="Buiding-from-YAML-1"></a><a class="docs-heading-anchor-permalink" href="#Buiding-from-YAML" title="Permalink"></a></h2><p>One can alternatively build a <code>LinearChain</code> from a yaml file. If the file <code>normal_mode.yaml</code> has the following contents:</p><pre><code class="language-yaml hljs">---
x:
  - frequency: 1e6
    mode: [0.1, 0.5, 0.3, 0.8]
  - frequency: 2e6
    mode: [0.3, 0.6, 0.5, 3]
y:
  - frequency: 8e6
    mode: [1, 1, 1, 1]
ionpositions: [1,2,3,4]</code></pre><p>Then this can be used to instantiate a <code>LinearChain</code> using:</p><pre><code class="language-julia hljs">chain = LinearChain_fromyaml(
    ions=[c, c, c, c],
    yaml=&quot;normal_mode.yaml&quot;,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearChain(4 ions)</code></pre><h2 id="Additional-Functionality"><a class="docs-heading-anchor" href="#Additional-Functionality">Additional Functionality</a><a id="Additional-Functionality-1"></a><a class="docs-heading-anchor-permalink" href="#Additional-Functionality" title="Permalink"></a></h2><p>A normal mode calculation can be performed without the need for a <code>LinearChain</code> using <code>full_normal_mode_description</code>.</p><pre><code class="language-julia hljs">mass_list =    [1, 1, 1, 1, 1]
charge_list =  [2, 1, 2, 2, 1]
fnm = full_normal_mode_description(mass_list, charge_list, (x=5e6, y=5e6, z=1e6))
fnm.x</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Tuple{Float64, Vector{Float64}}}:
 (4.999999999995645e6, [0.6057584914661734, 0.11812621584240938, 0.5260995812418203, 0.583082596466988, 0.04834008131845957])
 (4.915916957819456e6, [0.7826412154137659, 0.032418418050697326, -0.30779630853516393, -0.5382970359893425, -0.04381218556484292])
 (4.593768092555486e6, [0.11369990346572717, -0.09498304988480277, -0.7823562826899958, 0.6025950696370188, 0.05337022738487856])
 (3.4484213161962545e6, [0.001426876536388351, -0.004880961222275375, -0.0023165314760899736, 0.084205212689081, -0.996432765458264])
 (3.0906780717857066e6, [0.0871761086968414, -0.9879016346549745, 0.12803883663451218, -0.0062968998362194235, 0.00413420902221687])</code></pre><pre><code class="language-julia hljs">visualize(fnm.x[2], zÌ, format=&quot;circles&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="iontraps.html">Â« IonTrap</a><a class="docs-footer-nextpage" href="vibrationalmodes.html">VibrationalMode Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 10 April 2023 22:38">Monday 10 April 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
